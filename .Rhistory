wd("C:/Users/Blake/Desktop/WWTD Processes/Lab Data")
setwd("C:/Users/Blake/Desktop/WWTD Processes/Lab Data")
dir_path<-c("C:\Users\Blake\Desktop\WWTD Processes\Lab Data")
setwd("dir_path")
dir_path<-c("C/Users/Blake/Desktop/WWTD Processes/Lab Data")
setwd("dir_path")
setwd(dir_path)
getwd()
files<-list.files(Path=dir_path)
files<-list.files(path=dir_path)
dir_path<-c("C:/Users/Blake/Desktop/WWTD Processes/Lab Data")
dir_path<-c("C:/Users/Blake/Desktop/WWTD Processes/Lab Data")
files<-list.files(path=dir_path)
class(files)
library('xlxs')
library('xlsx')
read_Current_Month<-read.xlsx2(files)
read_Current_Month<-read.xlsx2(files,sheetIndex=1)
read_Current_Month<-read.xlsx(files,sheetIndex=1)
library('gdata')
install.packages('gdata')
library('gdata')
installXLSXsupport()'
installXLSXsupport()
read_Current_Month<-read.xls(files,sheetIndex=1)
read_Current_Month<-read.xls(files,sheetIndex=1,fileEncoding="latin1")
library('xlsx2')
library('xlsx')
dir_path<-c("C:/Users/Blake/Desktop/WWTD Processes/Lab Data")
files<-list.files(path=dir_path)
read_Current_Month<-read.xls(files,sheetIndex=1,fileEncoding="latin1")
read_Current_Month<-read.xlsx2(files,sheetIndex=1)
dir_path<-c("C:/Users/Blake/Desktop/WWTD Processes/Lab Data")
files<-list.files(path=dir_path)
read_Current_Month<-read.xlsx2(files,sheetIndex=1)
rm(files)
files<-list.files(path=dir_path)
files<-list.files(path=dir_path)
read_Current_Month<-read.xlsx2(files[1],sheetIndex=1)
Read_Current_Month<-read.xlsx2(files[1],sheetIndex=1)
class(Read_Current_Month)
read_Current_Month<-function()
{
#Packages to Add
library('xlsx')
#Setting Work Database
dir_path<-c("C:/Users/Blake/Desktop/WWTD Processes/Lab Data")
files<-list.files(path=dir_path)
Read_Current_Month<-read.xlsx2(files[1],sheetIndex=1)
return(Read_Current_Month)
}
Read_Current_Month<-function()
{
#Packages to Add
library('xlsx')
#Setting Work Database
dir_path<-c("C:/Users/Blake/Desktop/WWTD Processes/Lab Data")
files<-list.files(path=dir_path)
Read_Current_Month<-read.xlsx2(files[1],sheetIndex=1)
return(Read_Current_Month)
}
rm(read_Current_Month)
hold_1<-lapply(Read_Current_Month,as.character)
rm(hold_1)
Data<-Read_Current_Month
Data<-Read_Current_Month()
View(Data)
Label_1<-lablels(Raw_Data)
Label_1<-labels(Raw_Data)
Raw_Data<-Data
Label_1<-labels(Raw_Data)
Label_1<-labels(Raw_Data)[2]
Width<-dim(Raw_Data)[1]
class(width)
class(Width)
Length<-dim(Raw_Data)[1]
Width<-dim(Raw_Data)[2]
label_2<-c(Label_1,"Test",Value)
label_2<-c(Label_1,"Test","Value")
hold<-data.frame()
class(Data[1])
class(Data[[1]])
as.POSIXct(((as.numeric(42217-1)*60*60*24-12*60*60),origin="1900-01-01 00:00.00")
as.POSIXct(((42217-1)*60*60*24-12*60*60),origin="1900-01-01 00:00.00")
as.POSIXct(((42217-1)*60*60*24-12*60*60-7),origin="1900-01-01 00:00.00")
as.POSIXct(((42217-1)*60*60*24-19*60*60),origin="1900-01-01 00:00.00")
as.POSIXct(((42217-1)*60*60*24-19*60*60+1),origin="1900-01-01 00:00.00")
rm(Data,hold,Label_1,Length,Width,dir_lpath,files,labels_2)
rm(label_2)
Tidy_Data<-function(Raw_Data){
#Get Labels
Label_1<-labels(Raw_Data)[2]
# Dimensions of Excel Sheet
Length<-dim(Raw_Data)[1]
Width<-dim(Raw_Data)[2]
Data_Start=6
label_2<-c(Label_1,"Test","Value")
hold<-data.frame()
# Read from reach row
for (i in 1:Length){
hold_2<-vector(mode=character,length=7)
hold_2[1]<-as.character(Raw_Data[i,1])
hold_2[2]<-as.character(Raw_Data[i,2])
hold_2[3]<-as.character(Raw_Data[i,3])
hold_2[4]<-as.character(Raw_Data[i,4])
hold_2[5]<-as.character(Raw_Data[i,5])
# Read from each Column
for(j in 6:Width){
hold_2[6]<-as.character(Label_1[j])
hold_2[7]<-as.character(Raw_Data[i,j])
hold<-rbind(hold,hold_2)
}
}
# Update Data Classes
Tidy_Data<-data.frame()
Tidy_Data[[1]]<-as.character(hold[[1]])
Tidy_Data[[2]]<-as.character(hold[[2]])
Tidy_Data[[3]]<-as.factor(hold[[3]])
Tidy_Data[[4]]<-as.factor(hold[[4]])
# Date Information
test=as.POSIXct(((as.numeric(hold[[5]]-1)*60*60*24-19*60*60+1),origin="1900-01-01 00:00.00")
Tidy_Data[[5]]<-test
Tidy_Data[[6]]<-as.factor(hold[[6]])
Tidy_Data[[7]]<-as.numeric(hold[[7]])
row.names(Tidy_Data) <- lablels_2
return(Tidy_Data)
}
Tidy_Data<-function(Raw_Data){
#Get Labels
Label_1<-labels(Raw_Data)[2]
# Dimensions of Excel Sheet
Length<-dim(Raw_Data)[1]
Width<-dim(Raw_Data)[2]
Data_Start=6
label_2<-c(Label_1,"Test","Value")
hold<-data.frame()
# Read from reach row
for (i in 1:Length){
hold_2<-vector(mode=character,length=7)
hold_2[1]<-as.character(Raw_Data[i,1])
hold_2[2]<-as.character(Raw_Data[i,2])
hold_2[3]<-as.character(Raw_Data[i,3])
hold_2[4]<-as.character(Raw_Data[i,4])
hold_2[5]<-as.character(Raw_Data[i,5])
# Read from each Column
for(j in 6:Width){
hold_2[6]<-as.character(Label_1[j])
hold_2[7]<-as.character(Raw_Data[i,j])
hold<-rbind(hold,hold_2)
}
}
# Update Data Classes
Tidy_Data<-data.frame()
Tidy_Data[[1]]<-as.character(hold[[1]])
Tidy_Data[[2]]<-as.character(hold[[2]])
Tidy_Data[[3]]<-as.factor(hold[[3]])
Tidy_Data[[4]]<-as.factor(hold[[4]])
# Date Information
test=as.POSIXct(((as.numeric(hold[[5]])-1)*60*60*24-19*60*60+1),origin="1900-01-01 00:00.00")
Tidy_Data[[5]]<-test
Tidy_Data[[6]]<-as.factor(hold[[6]])
Tidy_Data[[7]]<-as.numeric(hold[[7]])
row.names(Tidy_Data) <- lablels_2
return(Tidy_Data)
}
test=as.POSIXct(((as.numeric(c(42217,42217,42217))-1)*60*60*24-19*60*60+1),origin="1900-01-01 00:00.00")
test
rm(test)
Cleaned_Data<-Tidy_Data(Raw_Data)
